## Session 7A - Modelica Language
<table><tr><th>Title:</th>
<td>Handling Multimode Models and Mode Changes in Modelica</td>
</tr>
<tr><th>Authors:</th>
<td>
<a href="/proceedings/authors/AlbertBenveniste">Albert Benveniste</a>, <a href="/proceedings/authors/BenoitCaillaud">Benoît Caillaud</a> and <a href="/proceedings/authors/MathiasMalandain">Mathias Malandain</a></td>
</tr>
<tr><th>Abstract:</th>
<td>Since its version 3.3, the Modelica language offers the possibility to model multimode systems having different DAE-based dynamics in each mode, thanks to the introduction of state machines. When the differentiation index and structure varies with mode changes, compilers generate erroneous simulation code, often resulting in runtime exceptions.

We propose in this paper amultimode structural analysis for both multiple modes and mode change events and we show how correct code for restarts can be generated. Our approach is illustrated on two simple but representative mechanical systems.</td></tr>
<tr><th>Keywords:</th>
<td>multimode DAE, structural analysis, mode change events</td></tr>
<tr><th>Paper:</th>
<td><a href="https://doi.org/10.3384/ecp21181507">full paper</a></td>
</tr>
<tr><th>Bibtex:</th>
<td><pre>
@InProceedings{modelica.org:Benveniste:2021a,
  title = {Handling Multimode Models and Mode Changes in Modelica},
  author = {Albert Benveniste and Benoît Caillaud and Mathias Malandain},
  pages = {507--517},
  doi = {10.3384/ecp21181507},
  booktitle = {Proceedings of the 14th International Modelica Conference},
  location = {Link\&quot;{o}ping, Sweden},
  editor = {Martin Sjölund and Lena Buffoni and Adrian Pop and Lennart Ochel},
  isbn = {978-91-7929-027-6},
  issn = {1650-3740},
  month = sep,
  series = {Linköping Electronic Conference Proceedings},
  number = {181},
  publisher = {Modelica Association and Linköping University Electronic Press},
  year = {2021}
}
</pre></td></tr>
</table><br>
<table><tr><th>Title:</th>
<td>A Reduced Index Mode-Independent Structure Model Transformation for Multimode Modelica Models</td>
</tr>
<tr><th>Authors:</th>
<td>
<a href="/proceedings/authors/BenoitCaillaud">Benoît Caillaud</a>, <a href="/proceedings/authors/MathiasMalandain">Mathias Malandain</a> and <a href="/proceedings/authors/AlbertBenveniste">Albert Benveniste</a></td>
</tr>
<tr><th>Abstract:</th>
<td>Since its 3.3 release, Modelica offers the possibility to specify models of dynamical systems with multiple modes having different DAE-based dynamics. However, the handling of such models by the current Modelica tools is not satisfactory, with mathematically sound models yielding exceptions at runtime. In this article, we propose a systematic way of rewriting a multimode Modelica model, based on the results of an already implemented multimode structural analysis. The rewritten Modelica model is guaranteed to be correctly compiled by state-of-the-art Modelica tools. Simulation results are presented on a simple, yet meaningful, physical system whose original Modelica model is not correctly handled by state-of-the-art Modelica tools.</td></tr>
<tr><th>Keywords:</th>
<td>Modelica, multimode DAE, structural analysis, model transformations</td></tr>
<tr><th>Paper:</th>
<td><a href="https://doi.org/10.3384/ecp21181519">full paper</a></td>
</tr>
<tr><th>Bibtex:</th>
<td><pre>
@InProceedings{modelica.org:Caillaud:2021,
  title = {A Reduced Index Mode-Independent Structure Model Transformation for Multimode Modelica Models},
  author = {Benoît Caillaud and Mathias Malandain and Albert Benveniste},
  pages = {519--528},
  doi = {10.3384/ecp21181519},
  booktitle = {Proceedings of the 14th International Modelica Conference},
  location = {Link\&quot;{o}ping, Sweden},
  editor = {Martin Sjölund and Lena Buffoni and Adrian Pop and Lennart Ochel},
  isbn = {978-91-7929-027-6},
  issn = {1650-3740},
  month = sep,
  series = {Linköping Electronic Conference Proceedings},
  number = {181},
  publisher = {Modelica Association and Linköping University Electronic Press},
  year = {2021}
}
</pre></td></tr>
</table><br>
<table><tr><th>Title:</th>
<td>Evaluating a Tree Diff Algorithm for Use in Modelica Tools</td>
</tr>
<tr><th>Authors:</th>
<td>
<a href="/proceedings/authors/MartinSjolund">Martin Sjölund</a></td>
</tr>
<tr><th>Abstract:</th>
<td>Modelica tools change the formatting of the source code when performing operations in the graphical user interface.
These unintended changes cause problems for source code management where during a code review you will mostly see changes that do not perform anything.
The intent of this work is to present a workflow where edits from an interactive environment do not contain these unintended changes when using the source code management system.

A diff tool that can merge two Modelica files and produce a merged copy is presented and evaluated.
The diff algorithm works by comparing syntax subtrees of Modelica code and having some domain knowledge about which subtrees belong together, speeding up the diff algorithm.
The result is a merged file by taking formatting of the first file and the semantics from the second file.
This works very well for smaller changes (a single edit) and scales with file size (making the user interface faster for smaller files).
To test the algorithm on a larger set of changes, a conversion script was applied to a set of libraries and the performance was analyzed.
The results are very promising especially for Modelica libraries that are split into multiple files rather than a large single file.
Having a single large file takes slightly longer to process and produces additional formatting changes to a library developed as a set of smaller files.</td></tr>
<tr><th>Keywords:</th>
<td>Modelica, diff, file comparison, conversion script, interactive user interface</td></tr>
<tr><th>Paper:</th>
<td><a href="https://doi.org/10.3384/ecp21181529">full paper</a></td>
</tr>
<tr><th>Bibtex:</th>
<td><pre>
@InProceedings{modelica.org:Sjölund:2021,
  title = {Evaluating a Tree Diff Algorithm for Use in Modelica Tools},
  author = {Martin Sjölund},
  pages = {529--537},
  doi = {10.3384/ecp21181529},
  booktitle = {Proceedings of the 14th International Modelica Conference},
  location = {Link\&quot;{o}ping, Sweden},
  editor = {Martin Sjölund and Lena Buffoni and Adrian Pop and Lennart Ochel},
  isbn = {978-91-7929-027-6},
  issn = {1650-3740},
  month = sep,
  series = {Linköping Electronic Conference Proceedings},
  number = {181},
  publisher = {Modelica Association and Linköping University Electronic Press},
  year = {2021}
}
</pre></td></tr>
</table><br>
<table><tr><th>Title:</th>
<td>Numerically Robust Six-Equation Two-Phase Flow Model for Stationary and Moving Systems in Modelica</td>
</tr>
<tr><th>Authors:</th>
<td>
<a href="/proceedings/authors/JohannesBrunnemann">Johannes Brunnemann</a>, <a href="/proceedings/authors/AlesVojacek">Ales Vojacek</a> and <a href="/proceedings/authors/ThomasKoch">Thomas Koch</a></td>
</tr>
<tr><th>Abstract:</th>
<td>We present a physics based Modelica ﬁnite volume ﬂow model that separately balances vapour and liquid phase. By using extensive state variables and a special mass ﬂow regularisation, the model can cope with the possible vanishing or emerging of a phase in a numerically robust way. Although at prototype stage, the model already exhibits all required capabilities. These are demonstrated in feature testers and in a model of a natural convection driven cooling cycle operating under external acceleration forces.</td></tr>
<tr><th>Keywords:</th>
<td>two phase ﬂow, six equation model, cooling cycle, natural convection, moving systems, ClaRa library</td></tr>
<tr><th>Paper:</th>
<td><a href="https://doi.org/10.3384/ecp21181539">full paper</a></td>
</tr>
<tr><th>Bibtex:</th>
<td><pre>
@InProceedings{modelica.org:Brunnemann:2021,
  title = {Numerically Robust Six-Equation Two-Phase Flow Model for Stationary and Moving Systems in Modelica},
  author = {Johannes Brunnemann and Ales Vojacek and Thomas Koch},
  pages = {539--548},
  doi = {10.3384/ecp21181539},
  booktitle = {Proceedings of the 14th International Modelica Conference},
  location = {Link\&quot;{o}ping, Sweden},
  editor = {Martin Sjölund and Lena Buffoni and Adrian Pop and Lennart Ochel},
  isbn = {978-91-7929-027-6},
  issn = {1650-3740},
  month = sep,
  series = {Linköping Electronic Conference Proceedings},
  number = {181},
  publisher = {Modelica Association and Linköping University Electronic Press},
  year = {2021}
}
</pre></td></tr>
</table><br>
<table><tr><th>Title:</th>
<td>Compile-Time Impulse Analysis in Modelica</td>
</tr>
<tr><th>Authors:</th>
<td>
<a href="/proceedings/authors/AlbertBenveniste">Albert Benveniste</a>, <a href="/proceedings/authors/BenoitCaillaud">Benoît Caillaud</a> and <a href="/proceedings/authors/MathiasMalandain">Mathias Malandain</a></td>
</tr>
<tr><th>Abstract:</th>
<td>Since its 3.3 release, Modelica offers the possibility to specify models of dynamical systems with multiple modes having different DAE-based dynamics. However, the handling of mode changes by the current Modelica tools is not satisfactory. 

An important difficulty is the occurrence of impulsive behavior at some mode changes, for some variables. In this paper, we propose a compile-time algorithm for identifying such impulsive behaviors and quantifying them in terms of their magnitude orders. Such algorithm can be used as an additional step of the structural analysis of Modelica models.</td></tr>
<tr><th>Keywords:</th>
<td>DAE, multimode DAE, structural analysis, impulsive behaviors</td></tr>
<tr><th>Paper:</th>
<td><a href="https://doi.org/10.3384/ecp21181549">full paper</a></td>
</tr>
<tr><th>Bibtex:</th>
<td><pre>
@InProceedings{modelica.org:Benveniste:2021b,
  title = {Compile-Time Impulse Analysis in Modelica},
  author = {Albert Benveniste and Benoît Caillaud and Mathias Malandain},
  pages = {549--559},
  doi = {10.3384/ecp21181549},
  booktitle = {Proceedings of the 14th International Modelica Conference},
  location = {Link\&quot;{o}ping, Sweden},
  editor = {Martin Sjölund and Lena Buffoni and Adrian Pop and Lennart Ochel},
  isbn = {978-91-7929-027-6},
  issn = {1650-3740},
  month = sep,
  series = {Linköping Electronic Conference Proceedings},
  number = {181},
  publisher = {Modelica Association and Linköping University Electronic Press},
  year = {2021}
}
</pre></td></tr>
</table><br>
